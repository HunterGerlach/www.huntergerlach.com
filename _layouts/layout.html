<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	  <meta name="author" content="{{ site.author }}" />
    {% if page.title %}
      <title>{{ page.title }} | {{ site.title }}</title>
    {% else %}
      <title>{{ site.title }}</title>
    {% endif %}

    {% assign page_title = page.title | default: site.title %}
    {% assign page_description = page.excerpt | strip_html | truncate: 160 | default: site.description %}
    {% assign page_url = page.url | prepend: site.url %}
    {% assign page_image = site.url | append: site.baseurl | append: "/static/img/" | append: site.avatar %}

    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self' https://www.googletagmanager.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com; font-src https://fonts.gstatic.com; img-src 'self' https://avatars.githubusercontent.com; connect-src https://api.github.com https://www.google-analytics.com https://www.googletagmanager.com; form-action https://formspree.io; frame-ancestors 'none'; base-uri 'self'">
    <meta name="description" content="{{ page_description }}">
    <link rel="canonical" href="{{ page_url }}">
    <link rel="icon" type="image/x-icon" href="{{ site.baseurl }}/favicon.ico">

    <!-- Preconnect to external origins -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Open Graph -->
    <meta property="og:title" content="{{ page_title }}">
    <meta property="og:description" content="{{ page_description }}">
    <meta property="og:url" content="{{ page_url }}">
    <meta property="og:image" content="{{ page_image }}">
    <meta property="og:site_name" content="{{ site.title }}">
    {% if page.layout == 'post' %}
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
    <meta property="article:author" content="{{ site.author }}">
    {% else %}
    <meta property="og:type" content="website">
    {% endif %}

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@{{ site.twitter }}">
    <meta name="twitter:title" content="{{ page_title }}">
    <meta name="twitter:description" content="{{ page_description }}">
    <meta name="twitter:image" content="{{ page_image }}">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
    crossorigin="anonymous">

    <!-- Custom styles -->
    <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/static/css/main.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@200;400&display=swap" />
    <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/static/css/syntax.css" />
    <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/static/css/comments.css" />

    <!-- Structured Data -->
    {% if page.layout == 'post' %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": {{ page.title | jsonify }},
      "datePublished": "{{ page.date | date_to_xmlschema }}",
      "author": { "@type": "Person", "name": {{ site.author | jsonify }} },
      "url": {{ page_url | jsonify }},
      "image": {{ page_image | jsonify }}
    }
    </script>
    {% else %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": {{ site.title | jsonify }},
      "url": {{ site.url | jsonify }},
      "author": { "@type": "Person", "name": {{ site.author | jsonify }} }
    }
    </script>
    {% endif %}

    <!-- Google Analytics -->
    {% include analytics.html %}
  </head>
  <!-- Main Body-->
  <body>
  <!-- Wrap all page content here -->
  <div id="wrap">
    <!-- Navbar header -->
    {% include header.html %}

    {{ content }}

  </div>
  <!-- Footer -->
  {% include footer.html %}

  </body>
</html>
